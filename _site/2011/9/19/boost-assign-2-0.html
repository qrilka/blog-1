<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<link href='http://fonts.googleapis.com/css?family=Cuprum:400,400italic,700&subset=latin,cyrillic,latin-ext' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Lobster&subset=latin,cyrillic,latin-ext' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Philosopher:400,400italic,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>
<title>Boost.Assign 2.0: упрощение или усложнение? &#8211; Мысли вслух</title>
<meta name="description" content="блог C++-программиста, влюбившегося в Haskell">
<meta name="keywords" content="Boost">

<!-- Twitter Cards -->
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://blog.dshevchenko.biz/images/site-logo.png">
<meta name="twitter:title" content="Boost.Assign 2.0: упрощение или усложнение?">
<meta name="twitter:description" content="блог C++-программиста, влюбившегося в Haskell">
<meta name="twitter:creator" content="@dshevchenko_biz">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Boost.Assign 2.0: упрощение или усложнение?">
<meta property="og:description" content="блог C++-программиста, влюбившегося в Haskell">
<meta property="og:url" content="http://blog.dshevchenko.biz/2011/9/19/boost-assign-2-0.html">
<meta property="og:site_name" content="Мысли вслух">





<link rel="canonical" href="http://blog.dshevchenko.biz/2011/9/19/boost-assign-2-0.html">
<link href="http://blog.dshevchenko.biz/feed.xml" type="application/atom+xml" rel="alternate" title="Мысли вслух Feed">
<link rel="author" href="https://google.com/+DenisShevchenko?rel=author">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="http://blog.dshevchenko.biz/assets/css/main.min.css">
<!-- Webfonts -->
<script src="//use.edgefonts.net/source-sans-pro:n2,i2,n3,i3,n4,i4,n6,i6,n7,i7,n9,i9;source-code-pro:n4,n7;volkhov.js"></script>

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script src="http://blog.dshevchenko.biz/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://blog.dshevchenko.biz/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://blog.dshevchenko.biz/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://blog.dshevchenko.biz/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://blog.dshevchenko.biz/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://blog.dshevchenko.biz/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://blog.dshevchenko.biz/images/apple-touch-icon-144x144-precomposed.png">

</head>

<body id="post">

<div class="navigation-wrapper">
	<nav role="navigation" id="site-nav" class="animated drop">
	    <ul>
	        
			<li>
				
					<a href="http://blog.dshevchenko.biz/articles/">Записи</a>
				 
			</li>
	        
			<li>
				
					<a href="http://blog.dshevchenko.biz/friends/">Друзья</a>
				 
			</li>
	        
			<li>
				
					<a href="http://blog.dshevchenko.biz/about/">О себе</a>
				 
			</li>
	        
			<li>
				
					<a href="http://ohaskell.ru">О Haskell</a>
				 
			</li>
	        
			<li>
				
					<a href="http://blog.dshevchenko.biz/tags/">Метки</a>
				 
			</li>
	        
	        <li><a href="http://blog.dshevchenko.biz/feed.xml" title="Atom/RSS feed"><i class="icon-rss"></i> Feed</a></li>
	        <li class="dosearch"><i class="icon-search"></i> Поиск</li>
	    </ul>
	</nav>
</div><!-- /.navigation-wrapper -->

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->

<div class="search-wrapper">
	<div class="search-form">
		<input type="text" class="search-field" placeholder="Ищем...">
		<i class="icon-remove-sign icon-2x"></i>
		<ul class="search-results post-list"></ul><!-- /.search-results -->
	</div><!-- /.search-form -->
</div><!-- ./search-wrapper -->

<header class="masthead">
	<div class="wrap">
        
    		<a href="http://blog.dshevchenko.biz/" class="site-logo" rel="home" title="Мысли вслух"><img src="http://blog.dshevchenko.biz/images/site-logo.png" width="200" height="200" alt="Мысли вслух logo" class="animated fadeInUp"></a>
        
        <h1 class="site-title animated fadeIn"><a href="http://blog.dshevchenko.biz/">Мысли вслух</a></h1>
		<h2 class="site-description animated fadeIn" itemprop="description">блог C++-программиста, влюбившегося в Haskell</h2>
	</div>
</header><!-- /.masthead -->


<div id="main" role="main">
  <article class="hentry">
    
    <div class="entry-wrapper">
      <header class="entry-header">
        <span class="entry-tags"><a href="http://blog.dshevchenko.biz/tags/#Boost" title="Pages tagged Boost">Boost</a></span>
        
          <h1 class="entry-title">Boost.Assign 2.0: упрощение или усложнение?</h1>
        
      </header>
      <footer class="entry-meta">
        <!-- <img src="http://blog.dshevchenko.biz/images/bio-photo.jpg" alt="Денис Шевченко photo" class="author-photo">
        <span class="author vcard">By <span class="fn"><a href="http://blog.dshevchenko.biz/about/" title="About Денис Шевченко">Денис Шевченко</a></span></span> -->
        <span class="entry-date date published"><time datetime="2011-09-19T00:00:00+05:00"><i class="icon-calendar-empty"></i> сентябрь 19, 2011</time></span>
        
        <span><a href="http://blog.dshevchenko.biz/2011/9/19/boost-assign-2-0.html" rel="bookmark" title="Boost.Assign 2.0: упрощение или усложнение?"><i class="icon-link"></i> Вечная ссылка</a></span>
        <span class="entry-comments"><i class="icon-comment-alt"></i> <a href="#disqus_thread">Комментарии</a></span>
        
        <span class="social-share-facebook">
            <a href="https://www.facebook.com/sharer/sharer.php?u=http://blog.dshevchenko.biz/2011/9/19/boost-assign-2-0.html" title="Share on Facebook" itemprop="Facebook"><i class="icon-facebook-sign"></i> Like</a></span>
        <span class="social-share-twitter">
            <a href="https://twitter.com/intent/tweet?hashtags=articles&text=Boost.Assign 2.0: упрощение или усложнение?&url=http://blog.dshevchenko.biz/2011/9/19/boost-assign-2-0.html&via=dshevchenko_biz" title="Share on Twitter" itemprop="Twitter"><i class="icon-twitter-sign"></i> Tweet</a></span>
        <span class="social-share-googleplus">
            <a href="https://plus.google.com/share?url=http://blog.dshevchenko.biz/2011/9/19/boost-assign-2-0.html" title="Share on Google Plus" itemprop="GooglePlus"><i class="icon-google-plus-sign"></i> +1</a></span>
            <!-- /.social-share -->
      </footer>
      <div class="entry-content">
        <p>Ну, во-первых, если кому-то интересно взглянуть на документацию к этому хозяйству - прошу <a href="http://svn.boost.org/svn/boost/sandbox/assign_v2/libs/assign/v2/doc/html/index.html"><strong>сюда</strong></a>.</p>

<p>А, во-вторых, давайте вспомним, зачему была нужна эта библиотека? Она нужна была для того, чтобы упростить жизнь программиста. И не просто упростить, но сделать это <em>быстро</em>.</p>

<p>Давайте взглянем на самый первый пример использования первой Assign (желающие ознакомиться лично - <a href="http://www.boost.org/doc/libs/1_46_1/libs/assign/doc/index.html"><strong>сюда</strong></a>):</p>

<div class="highlight"><pre><code class="cpp"><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">v</span><span class="p">;</span> 
<span class="n">v</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">;</span>

<span class="n">map</span><span class="o">&lt;</span><span class="n">string</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">m</span><span class="p">;</span> 
<span class="n">insert</span><span class="p">(</span> <span class="n">m</span> <span class="p">)(</span> <span class="s">&quot;Bar&quot;</span><span class="p">,</span> <span class="mi">1</span> <span class="p">)(</span> <span class="s">&quot;Foo&quot;</span><span class="p">,</span> <span class="mi">2</span> <span class="p">);</span>
</code></pre></div>

<p>Согласитесь, что даже без чтения остальной документации <em>любой</em> программист, имеющий хоть какой-то опыт работы с vector и map, поймёт этот код. Знаете почему? Потому что этот код простой. Я подчёркиваю: он простой даже для новичка. </p>

<p>Более того, этот новичок сможет начать использовать такую библиотеку <em>сразу же</em>, и ему не потребуется изучать всю документацию для этого. Это и есть то, что я называю: “библиотека, упрощающая жизнь программиста”.</p>

<p>А теперь взглянем на самый первый пример использования Assign 2.0 (он <strong><a href="http://svn.boost.org/svn/boost/sandbox/assign_v2/libs/assign/v2/doc/html/index.html">тут</a></strong>):</p>

<div class="highlight"><pre><code class="cpp"><span class="k">typedef</span> <span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;</span> <span class="n">map_</span><span class="p">;</span> <span class="n">map_</span> <span class="n">cal</span><span class="p">;</span>
<span class="k">typedef</span> <span class="n">map_</span><span class="o">::</span><span class="n">value_type</span> <span class="n">p_</span><span class="p">;</span>

<span class="n">boost</span><span class="o">::</span><span class="n">for_each</span><span class="p">(</span>
    <span class="n">cal</span> <span class="o">|</span> <span class="n">do_csv_put</span><span class="o">&lt;</span><span class="mi">2</span><span class="o">&gt;</span><span class="p">(</span> <span class="s">&quot;jan&quot;</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="s">&quot;feb&quot;</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="s">&quot;mar&quot;</span><span class="p">,</span> <span class="mi">31</span> <span class="p">),</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span>
        <span class="o">&lt;&lt;</span> <span class="n">lambda</span><span class="o">::</span><span class="n">bind</span><span class="p">(</span> <span class="o">&amp;</span><span class="n">p_</span><span class="o">::</span><span class="n">first</span><span class="p">,</span> <span class="n">lambda</span><span class="o">::</span><span class="n">_1</span> <span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;:&#39;</span>
        <span class="o">&lt;&lt;</span> <span class="n">lambda</span><span class="o">::</span><span class="n">bind</span><span class="p">(</span> <span class="o">&amp;</span><span class="n">p_</span><span class="o">::</span><span class="n">second</span><span class="p">,</span> <span class="n">lambda</span><span class="o">::</span> <span class="n">_1</span> <span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39; &#39;</span>
<span class="p">);</span> <span class="c1">// prints jan:31 feb:28 mar:31</span>
</code></pre></div>

<p>Э-э… Хм…  </p>

<p>Друзья, режьте меня на части, но я всё равно буду утверждать, что такой код отпугнёт новичка. Знаете почему? Потому что этот код сложный.</p>

<p>Вдумайтесь: это ведь самый первый и простейший пример, а-ля “Hello world”. Человек, который не знает, что такое lambda::bind и не знакомый с концепцией адаптеров (отражённной здесь перегруженным <code>operator|</code>) увидит это и подумает: “Ёлки-палки, если это - простейший пример, то что же там дальше?! И это библиотека для упрощения работы с контейнерами?!” Получается, такому человеку придётся хотя бы поверхностно познакомиться с лямбда-выражениями (и с Boost.Lambda в частности) только лишь для того, чтобы понять первый пример!</p>

<p>Я понимаю, есть библиотеки, который трудно начать использовать <em>сразу</em>. Spirit, MPL, Proto и некоторые другие действительно требуют достаточно глубокой подготовки. Но эти библиотеки являются серьёзными инструментами, и они вовсе не предназначены для того, чтобы их начали использовать через пару минут после установки Boost. Понятно, что если человек собирается создавать собственный DSEL на основе Proto, то он должен обладать достаточно глубокими знаниями C++, и ему, разумеется, придётся изучить документацию к Proto весьма глубоко.</p>

<p>Однако такие библиотеки, как Assign, именно для того и предназначены, чтобы их можно было использовать <em>сразу</em>, и чтобы высокой квалификации для этого не требовалось. Это те библиотеки, с которых начнёт новичок и по которым этот новичок будет судить о Boost в целом. И вот представьте себе, как он читает аннотацию к Assign:</p>

<p><strong>Filling containers with constant or generated data has never been easier.</strong></p>

<p>Чего-чего? Никогда не было проще? Вы что, издеваетесь? Я вспоминаю себя при освоении Assign первой версии, и если бы мне <em>тогда</em> дали Assign 2.0, я бы ужаснулся.</p>

<p>По моему мнению, авторы Assign 2.0 пошли куда-то не туда. Библиотека, предназначенная, по сути, лишь для того, чтобы упростить вставку элементов в контейнер, обязана быть простой. В противном случае зачем она нужна?</p>

        <div id="disqus_thread"></div><!-- /#disqus_thread -->
      </div><!-- /.entry-content -->
    </div><!-- /.entry-wrapper -->
    <nav class="pagination" role="navigation">
      
        <a href="http://blog.dshevchenko.biz/2011/9/19/accumulate.html" class="btn" title="accumulate и строки: подсказка">Предыдущий</a>
      
      
        <a href="http://blog.dshevchenko.biz/2011/9/19/boost-c11.html" class="btn" title="От Boost к C++11: частичный переход неизбежен">Следующий</a>
      
    </nav><!-- /.pagination -->
  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2011-2014 Денис Шевченко. Сайт работает на <a href="http://jekyllrb.com">Jekyll</a> с использованием <a href="http://mademistakes.com/so-simple/">So Simple Theme</a>.</span>
<div class="social-icons">
	<a href="http://twitter.com/dshevchenko_biz" title="В Twitter" target="_blank"><i class="icon-twitter icon-2x"></i></a>
	<a href="http://facebook.com/dshevchenko.biz" title="На Facebook" target="_blank"><i class="icon-facebook icon-2x"></i></a>
	<a href="https://google.com/+DenisShevchenko" title="На Google+" target="_blank"><i class="icon-google-plus icon-2x"></i></a>
	<a href="http://linkedin.com/in/dshevchenkobiz" title="И в LinkedIn я тоже есть" target="_blank"><i class="icon-linkedin icon-2x"></i></a>
	<a href="http://stackexchange.com/users/131381/denis-shevchenko" title="И даже на StackExchange я есть" target="_blank"><i class="icon-stackexchange icon-2x"></i></a>
	
	
	<a href="http://github.com/denisshevchenko" title="И конечно же на Github" target="_blank"><i class="icon-github icon-2x"></i></a>
	
</div><!-- /.social-icons -->

  </footer>
</div><!-- /.footer-wrapper -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://blog.dshevchenko.biz/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="http://blog.dshevchenko.biz/assets/js/scripts.min.js"></script>

<!-- Jekyll Simple Search option -->
<script>
  $(document).ready(function() {
      $('.search-field').simpleJekyllSearch({
          jsonFile : 'http://blog.dshevchenko.biz/search.json',
          searchResults : '.search-results',
          template : '<li><article><a href="{url}">{title} <span class="entry-date"><time datetime="{date}">{shortdate}</time></span></a></article></li>',
          noResults: '<p>Nothing found.</p>'
        });
  });

  (function( $, window, undefined ) {
    
     var bs = {
          close: $(".icon-remove-sign"),
          searchform: $(".search-form"),
          canvas: $("body"),
          dothis: $('.dosearch')
      };
    
    bs.dothis.on('click', function() {
      $('.search-wrapper').css({ display: "block" });
      bs.searchform.toggleClass('active');
      bs.searchform.find('input').focus();
      bs.canvas.toggleClass('search-overlay');
    });
    
      bs.close.on('click', function() {
        $('.search-wrapper').removeAttr( 'style' );
        bs.searchform.toggleClass('active');
        bs.canvas.removeClass('search-overlay');
    });
  })( jQuery, window );
</script>


<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'dshevchenko'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>	        

</body>
</html>
